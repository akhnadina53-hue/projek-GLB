<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Simulasi GLB â€“ Kotak Persegi Panjang</title>

<style>
    canvas {
        border: 1px solid black;
        margin-top: 10px;
    }
    #rumus {
        background: #f4f4f4;
        padding: 10px;
        margin-top: 10px;
    }
</style>
</head>

<body>

<h2>Simulasi Kejar-kejaran GLB (Kotak Persegi Panjang)</h2>

<label>xâ‚€ A (m):</label>
<input id="xA" type="number" value="0"><br><br>

<label>v A (m/s):</label>
<input id="vA" type="number" value="1"><br><br>

<label>xâ‚€ B (m):</label>
<input id="xB" type="number" value="12"><br><br>

<label>v B (m/s):</label>
<input id="vB" type="number" value="0.5"><br><br>

<button onclick="mulai()">â–¶ Play</button>
<button onclick="reset()">ðŸ”„ Reset</button>

<p id="hasil"></p>

<canvas id="kanvas" width="800" height="180"></canvas>

<div id="rumus"></div>

<script>
const canvas = document.getElementById("kanvas");
const ctx = canvas.getContext("2d");

let xA0, xB0, xA, xB, vA, vB, t;
let jalan = false;
let animasi;
let skala = 40;
let lebar = 40;
let tinggi = 30;

function mulai() {
    xA0 = xA = parseFloat(document.getElementById("xA").value);
    vA = parseFloat(document.getElementById("vA").value);
    xB0 = xB = parseFloat(document.getElementById("xB").value);
    vB = parseFloat(document.getElementById("vB").value);

    if (xA >= xB || vA <= vB) {
        hasil.innerHTML = "<b style='color:red'>A harus di belakang dan lebih cepat dari B</b>";
        return;
    }

    t = 0;
    jalan = true;
    animasi = requestAnimationFrame(gambar);
}

function reset() {
    cancelAnimationFrame(animasi);
    jalan = false;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    hasil.innerHTML = "";
    rumus.innerHTML = "";
}

function gambar() {
    if (!jalan) return;

    let dt = (xB - xA < 1) ? 0.005 : 0.02; // slow motion saat dekat

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // lintasan
    ctx.fillStyle = "#ddd";
    ctx.fillRect(20, 80, canvas.width - 40, 20);

    let jarak = xB - xA;

    // posisi pixel
    let pxA = xA * skala + 40;
    let pxB = xB * skala + 40;

    // jika bertemu â†’ menyatu
    if (pxA + lebar >= pxB) {
        ctx.fillStyle = "purple";
        ctx.fillRect(pxB, 65, lebar, tinggi);

        hasil.innerHTML =
            "ðŸ§² <b>A dan B bertemu & menyatu</b><br>" +
            "t = <b>" + t.toFixed(2) + " s</b>";

        jalan = false;
        return;
    }

    // kotak A (merah)
    ctx.fillStyle = "red";
    ctx.fillRect(pxA, 65, lebar, tinggi);
    ctx.fillStyle = "white";
    ctx.fillText("A", pxA + 15, 85);

    // kotak B (biru)
    ctx.fillStyle = "blue";
    ctx.fillRect(pxB, 65, lebar, tinggi);
    ctx.fillStyle = "white";
    ctx.fillText("B", pxB + 15, 85);

    // info
    ctx.fillStyle = "black";
    ctx.fillText(`t = ${t.toFixed(2)} s | jarak = ${jarak.toFixed(2)} m`, 10, 20);

    // rumus berjalan
    rumus.innerHTML = `
    <b>Rumus GLB:</b><br>
    x<sub>A</sub> = ${xA0} + ${vA}t = <b>${xA.toFixed(2)}</b><br>
    x<sub>B</sub> = ${xB0} + ${vB}t = <b>${xB.toFixed(2)}</b>
    `;

    // update posisi
    xA += vA * dt;
    xB += vB * dt;
    t += dt;

    animasi = requestAnimationFrame(gambar);
}
</script>

</body>
</html>
